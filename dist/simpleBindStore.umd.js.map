{"version":3,"file":"simpleBindStore.umd.js","sources":["../src/index.js"],"sourcesContent":["import simpleBind from 'simplebind.js';\r\n\r\nlet defaults = { \r\n  middleware: [], \r\n}; \r\n\r\nlet watchers = { }; \r\n\r\nexport function Store(name,state,conf={}) { \r\n  if(!(this instanceof Store)) return new Store(name,state,conf); \r\n  watchers[name] = this.externalStoreChange.bind(this); \r\n  this.name = name;\r\n  this.state = state; \r\n  this.conf = Object.keys(defaults).reduce((obj,key) => {\r\n    obj[key] = typeof conf[key] != 'undefined' ? conf[key] : defaults[key]; \r\n    return obj;\r\n  },{});\r\n  return this;\r\n}; \r\n\r\nStore.prototype.externalStoreChange = function(obj) { \r\n  this.state = obj;\r\n  this.runMiddleware();\r\n}; \r\n\r\nStore.prototype.runMiddleware = function() { \r\n  this.conf.middleware.reduce((state,mw) => mw.call(this,state), this.state);\r\n  return this;\r\n};\r\n\r\nStore.prototype.commit = function() { \r\n  this.runMiddleware();\r\n  simpleBind.bind(this.name,this.state);\r\n  return this;\r\n};\r\n\r\nexport function extendStore(child) { \r\n\tchild.prototype = Object.create(Store.prototype);\r\n\tchild.prototype.constructor = child;\r\n}; \r\n\r\nsimpleBind.registerPlugin({\r\n  name: 'simplebindStore',\r\n  preBind: function(objName,obj) { \r\n    if(watchers[objName]) watchers[objName](obj);\r\n    return obj;\r\n  }\r\n})"],"names":["let","this"],"mappings":";;;;;;;;EAEAA,IAAI,QAAQ,GAAG;IACb,UAAU,EAAE,EAAE;GACf,CAAC;;EAEFA,IAAI,QAAQ,GAAG,GAAG,CAAC;;AAEnB,EAAO,SAAS,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAO,EAAE;+BAAL,CAAC;EAAK;IACzC,GAAG,EAAE,IAAI,YAAY,KAAK,CAAC,IAAE,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAC;IAC/D,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACrD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACnB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,WAAE,GAAG,CAAC,GAAG,EAAE;MACjD,GAAG,CAAC,GAAG,CAAC,GAAG,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;MACvE,OAAO,GAAG,CAAC;KACZ,CAAC,EAAE,CAAC,CAAC;IACN,OAAO,IAAI,CAAC;GACb;EAED,KAAK,CAAC,SAAS,CAAC,mBAAmB,GAAG,SAAS,GAAG,EAAE;IAClD,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;IACjB,IAAI,CAAC,aAAa,EAAE,CAAC;GACtB,CAAC;;EAEF,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,WAAW;;EAAC;IAC1C,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,WAAE,KAAK,CAAC,EAAE,EAAE,SAAG,EAAE,CAAC,IAAI,CAACC,MAAI,CAAC,KAAK,IAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC3E,OAAO,IAAI,CAAC;GACb,CAAC;;EAEF,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,WAAW;IAClC,IAAI,CAAC,aAAa,EAAE,CAAC;IACrB,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACtC,OAAO,IAAI,CAAC;GACb,CAAC;;AAEF,EAAO,SAAS,WAAW,CAAC,KAAK,EAAE;GAClC,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;GACjD,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,KAAK,CAAC;GACpC;EAED,UAAU,CAAC,cAAc,CAAC;IACxB,IAAI,EAAE,iBAAiB;IACvB,OAAO,EAAE,SAAS,OAAO,CAAC,GAAG,EAAE;MAC7B,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAC;MAC7C,OAAO,GAAG,CAAC;KACZ;GACF;;;;;;;;;;;;;"}