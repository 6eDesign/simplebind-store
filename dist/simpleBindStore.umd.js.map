{"version":3,"file":"simpleBindStore.umd.js","sources":["../src/index.js"],"sourcesContent":["import simpleBind from 'simplebind.js';\r\n\r\nlet defaults = { \r\n  middleware: [], \r\n}; \r\n\r\nlet watchers = { }; \r\n\r\nexport function Store(name,state,conf={}) { \r\n  if(!(this instanceof Store)) return new Store(name,state,conf); \r\n  watchers[name] = this.externalStoreChange.bind(this); \r\n  this.name = name;\r\n  this.state = state; \r\n  this.conf = Object.keys(defaults).reduce((obj,key) => {\r\n    obj[key] = typeof conf[key] != 'undefined' ? conf[key] : defaults[key]; \r\n    return obj;\r\n  },{});\r\n  return this;\r\n}; \r\n\r\nStore.prototype.externalStoreChange = function(obj) { \r\n  this.state = obj;\r\n  this.runMiddleware();\r\n}; \r\n\r\nStore.prototype.runMiddleware = function() { \r\n  this.conf.middleware.reduce((state,mw) => mw.call(this,state), this.state);\r\n  return this;\r\n};\r\n\r\nStore.prototype.commit = function() { \r\n  this.runMiddleware();\r\n  simpleBind.bind(this.name,this.state);\r\n  return this;\r\n};\r\n\r\nexport function extendStore(child) { \r\n\tchild.prototype = Object.create(Store.prototype);\r\n\tchild.prototype.constructor = child;\r\n}; \r\n\r\nsimpleBind.registerPlugin({\r\n  name: 'simplebindStore',\r\n  preBind: function(objName,obj) { \r\n    if(watchers[objName]) watchers[objName](obj);\r\n    return obj;\r\n  }\r\n})"],"names":["let","defaults","middleware","watchers","Store","name","state","conf","this","externalStoreChange","bind","Object","keys","reduce","obj","key","prototype","runMiddleware","mw","call","commit","simpleBind","registerPlugin","preBind","objName","child","create","constructor"],"mappings":"uSAEAA,IAAIC,EAAW,CACbC,WAAY,IAGVC,EAAW,GAER,SAASC,EAAMC,EAAKC,EAAMC,GAC/B,sBADoC,IAC/BC,gBAAgBJ,GACrBD,EAASE,GAAQG,KAAKC,oBAAoBC,KAAKF,MAC/CA,KAAKH,KAAOA,EACZG,KAAKF,MAAQA,EACbE,KAAKD,KAAOI,OAAOC,KAAKX,GAAUY,gBAAQC,EAAIC,GAE5C,OADAD,EAAIC,QAA2B,IAAbR,EAAKQ,GAAsBR,EAAKQ,GAAOd,EAASc,GAC3DD,GACP,IACKN,MAR6B,IAAIJ,EAAMC,EAAKC,EAAMC,GAW3DH,EAAMY,UAAUP,oBAAsB,SAASK,GAC7CN,KAAKF,MAAQQ,EACbN,KAAKS,iBAGPb,EAAMY,UAAUC,cAAgB,sBAE9B,OADAT,KAAKD,KAAKL,WAAWW,gBAAQP,EAAMY,UAAOA,EAAGC,KAAKX,EAAKF,IAAQE,KAAKF,OAC7DE,MAGTJ,EAAMY,UAAUI,OAAS,WAGvB,OAFAZ,KAAKS,gBACLI,EAAWX,KAAKF,KAAKH,KAAKG,KAAKF,OACxBE,MAQTa,EAAWC,eAAe,CACxBjB,KAAM,kBACNkB,QAAS,SAASC,EAAQV,GAExB,OADGX,EAASqB,IAAUrB,EAASqB,GAASV,GACjCA,6BATJ,SAAqBW,GAC3BA,EAAMT,UAAYL,OAAOe,OAAOtB,EAAMY,WACtCS,EAAMT,UAAUW,YAAcF"}